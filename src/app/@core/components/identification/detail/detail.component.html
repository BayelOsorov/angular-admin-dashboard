<nb-alert *ngIf="error" class="sticky-alert slideInDown" status="danger"
    ><div class="my-alert">
        <div class="alert-text">
            <i class="nb-info"></i>
            <p>{{ error }}</p>
        </div>

        <button ghost nbButton (click)="closeAlert()">X</button>
    </div>
</nb-alert>
<div class="detail-info" *ngIf="data">
    <div class="status">
        <strong>{{ data.createdAt | date: 'dd.MM.yyyy, hh:mm' }}</strong>
        <strong>+{{ data.phoneNumber }}</strong>
        <nb-alert status="primary">{{
            data.status === 'VideoIdentificationProcess'
                ? 'Видео-идентификация '
                : 'Фото-идентификация'
        }}</nb-alert>
    </div>
    <div class="detail-block mt-4">
        <div class="row">
            <div class="first col-md-6">
                <p class="mx-auto">{{ data.pin }}</p>
                <ngx-identification-need-to-edit
                    [data]="identificationAnswers.pin"
                    [control]="form.get('Pin')"
                    placeholder="Введите"
                >
                </ngx-identification-need-to-edit>
                <p class="mx-auto mt-4">
                    {{ data.documentType + ' ' + data.documentNumber }}
                </p>
                <ngx-identification-need-to-edit
                    [data]="identificationAnswers.documentNumber"
                    [control]="form.get('Pin')"
                    placeholder="Введите"
                >
                </ngx-identification-need-to-edit>
            </div>
            <div class="second col-md-6">
                <nb-alert
                    *ngIf="!personalData"
                    status="danger"
                    class="danger-alert"
                >
                    <div>
                        <i class="nb-alert"></i>
                        <p>Нет данных для обработки</p>
                    </div>
                </nb-alert>
                <nb-alert
                    *ngIf="personalData"
                    status="success"
                    class="danger-alert"
                >
                    <div>
                        <i class="nb-checkmark-circle"></i>
                        <p>Данные готовы</p>
                    </div>
                </nb-alert>
            </div>
        </div>
        <div class="row mt-5">
            <div class="first col-md-6">
                <ngx-lightbox-img
                    [imgUrl]="data.passportFrontSideImageUrl"
                ></ngx-lightbox-img>
                <ngx-identification-need-to-edit
                    [data]="identificationAnswers.passportFrontSideImage"
                    [control]="form.get('PassportFrontSideImageId')"
                    placeholder="Введите"
                >
                </ngx-identification-need-to-edit>
            </div>
            <div *ngIf="personalData" class="second col-md-6">
                <table class="w-100">
                    <tr>
                        <td>Имя</td>
                        <td>{{ personalData.name }}</td>
                    </tr>
                    <tr>
                        <td>Фамилия</td>
                        <td>{{ personalData.surname }}</td>
                    </tr>
                    <tr>
                        <td>Отчество</td>
                        <td>{{ personalData.patronymic }}</td>
                    </tr>
                    <tr>
                        <td>Пол</td>
                        <td>{{ personalData.gender }}</td>
                    </tr>
                    <tr>
                        <td>Дата рождения</td>
                        <td>
                            {{ personalData.birthDate | date: 'dd.MM.yyyy' }}
                        </td>
                    </tr>

                    <tr>
                        <td>Срок действия паспорта</td>
                        <td>
                            {{ personalData.dateOfExpiry | date: 'dd.MM.yyyy' }}
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="row mt-5">
            <div class="first col-md-6">
                <ngx-lightbox-img
                    [imgUrl]="data.passportBackSideImageUrl"
                ></ngx-lightbox-img>
                <ngx-identification-need-to-edit
                    [data]="identificationAnswers.passportBackSideImage"
                    [control]="form.get('PassportBackSideImageId')"
                    placeholder="Введите"
                >
                </ngx-identification-need-to-edit>
            </div>
            <div *ngIf="personalData" class="second col-md-6">
                <table class="w-100">
                    <tr>
                        <td>ПИН</td>
                        <td>{{ personalData.pin }}</td>
                    </tr>
                    <tr>
                        <td>Паспорт</td>
                        <td>
                            {{
                                personalData.passportType +
                                    ' ' +
                                    personalData.documentNumber
                            }}
                        </td>
                    </tr>

                    <tr>
                        <td>Кем выдан</td>
                        <td>{{ personalData.authority }}</td>
                    </tr>
                    <tr>
                        <td>Дата выдачи</td>
                        <td>
                            {{ personalData.dateOfIssue | date: 'dd.MM.yyyy' }}
                        </td>
                    </tr>
                    <tr>
                        <td>Пол</td>
                        <td>{{ personalData.gender }}</td>
                    </tr>

                    <tr>
                        <td>Семейное положение</td>
                        <td>
                            {{ translate(personalData.maritalStatus) }}
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="row mt-5">
            <div class="first col-md-6">
                <ngx-lightbox-img
                    [imgUrl]="data.selfieWithPassportImageUrl"
                ></ngx-lightbox-img>
                <ngx-identification-need-to-edit
                    [data]="identificationAnswers.selfieWithPassportImage"
                    [control]="form.get('SelfieWithPassportImageId')"
                    placeholder="Введите"
                >
                </ngx-identification-need-to-edit>
                <p class="mx-auto mt-4">
                    {{
                        data.address.region +
                            ', ' +
                            data.address.locality +
                            ', ' +
                            data.address.street
                    }}
                </p>
                <ngx-identification-need-to-edit
                    [data]="identificationAnswers.address"
                    [control]="form.get('Address')"
                    placeholder="Введите"
                >
                </ngx-identification-need-to-edit>
            </div>
            <div *ngIf="personalData" class="second col-md-6">
                <ngx-lightbox-img
                    [imgUrl]="personalData.profilePhotoUrl"
                ></ngx-lightbox-img>
            </div>
        </div>
    </div>
    <ngx-photo-idn-buttons
        *ngIf="data.status === 'VideoIdentificationProcess'"
        [data]="data"
        [openvidu]="openvidu"
        (editEvent)="suspendVideoIdn()"
        (approveEvent)="approveVideoIdn()"
        (declineEvent)="declineVideoIdn()"
    ></ngx-photo-idn-buttons>
    <ngx-photo-idn-buttons
        *ngIf="data.status === 'PhotoIdentificationProcess'"
        [data]="data"
        [openvidu]="openvidu"
        (editEvent)="editPhotoIdn()"
        (approveEvent)="approvePhotoIdn()"
        (declineEvent)="declinePhotoIdn()"
    ></ngx-photo-idn-buttons>
    <ngx-openvidu
        *ngIf="data.status === 'VideoIdentificationProcess'"
        #openvidu
        [data]="data"
    ></ngx-openvidu>
    <!-- <div class="detail-images row">
        <ngx-lightbox-img
            class="col-md-4 first"
            [imgUrl]="data.passportFrontSideImageUrl"
        ></ngx-lightbox-img>

        <ngx-lightbox-img
            class="col-md-4"
            [imgUrl]="data.passportBackSideImageUrl"
        ></ngx-lightbox-img>

        <ngx-lightbox-img
            class="col-md-4"
            [imgUrl]="data.selfieWithPassportImageUrl"
        ></ngx-lightbox-img>
    </div>
    <div [@openClose]="toggle" class="data row" *ngIf="personalData && toggle">
        <img
            class="col-6 col-sm-3"
            [src]="personalData.profilePhotoUrl | useHttpImgSrc"
            alt=""
        />
        <table class="col-md-6 ml-3">
            <tr>
                <td>ПИН</td>
                <td>{{ personalData.pin }}</td>
            </tr>
            <tr>
                <td>Имя</td>
                <td>{{ personalData.name }}</td>
            </tr>
            <tr>
                <td>Фамилия</td>
                <td>{{ personalData.surname }}</td>
            </tr>
            <tr>
                <td>Отчество</td>
                <td>{{ personalData.patronymic }}</td>
            </tr>
            <tr>
                <td>Пол</td>
                <td>{{ personalData.gender }}</td>
            </tr>
            <tr>
                <td>Дата рождения</td>
                <td>{{ personalData.birthDate | date: 'dd.MM.yyyy' }}</td>
            </tr>
            <tr>
                <td>Семейное положение</td>
                <td>
                    {{ translate(personalData.maritalStatus) }}
                </td>
            </tr>
            <tr>
                <td>Адрес прописки</td>
                <td>{{ personalData.residenceAddress }}</td>
            </tr>
            <tr>
                <td>Паспорт</td>
                <td>
                    {{
                        personalData.passportType +
                            ' ' +
                            personalData.documentNumber
                    }}
                </td>
            </tr>
            <tr>
                <td>Дата выдачи</td>
                <td>{{ personalData.dateOfIssue | date: 'dd.MM.yyyy' }}</td>
            </tr>

            <tr>
                <td>Кем выдан</td>
                <td>{{ personalData.authority }}</td>
            </tr>
            <tr>
                <td>Срок действия паспорта</td>
                <td>
                    {{ personalData.dateOfExpiry | date: 'dd.MM.yyyy' }}
                </td>
            </tr>
        </table>
    </div>
    <button
        class="mx-auto d-flex mt-4"
        (click)="getDataToggle()"
        nbButton
        status="primary"
    >
        {{ !toggle ? 'Запросить паспортные данные' : 'Скрыть' }}
    </button>
    <ngx-photo-idn-buttons
        *ngIf="data.status === 'VideoIdentificationProcess'"
        [isInfoOpened]="toggle"
        [data]="data"
        [openvidu]="openvidu"
        [isPhotoIdnNeedToEdit]="isNeedToEdit"
        (editEvent)="suspendVideoIdn()"
        (approveEvent)="approveVideoIdn()"
        (declineEvent)="declineVideoIdn()"
    ></ngx-photo-idn-buttons>
    <ngx-photo-idn-buttons
        *ngIf="data.status !== 'VideoIdentificationProcess'"
        [isInfoOpened]="toggle"
        [data]="data"
        [openvidu]="openvidu"
        [isPhotoIdnNeedToEdit]="isNeedToEdit"
        (editEvent)="editPhotoIdn()"
        (approveEvent)="approvePhotoIdn()"
        (declineEvent)="declinePhotoIdn()"
    ></ngx-photo-idn-buttons>
    <ngx-identification-need-to-edit
        [data]="data"
        [isNeedToEdit]="isNeedToEdit"
        (hideEditEvent)="hideEdit($event)"
    ></ngx-identification-need-to-edit>
    <ngx-openvidu #openvidu [data]="data"></ngx-openvidu> -->
</div>
